<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="450" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="buildGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e1f5fe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0277bd;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="prodGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e8f5e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4caf50;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="450" fill="#fafafa"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#333">멀티 스테이지 빌드 플로우</text>
  
  <!-- Build Stage -->
  <g id="buildStage">
    <rect x="50" y="70" width="300" height="300" fill="url(#buildGradient)" stroke="#0277bd" stroke-width="3" rx="15"/>
    <text x="200" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#fff">빌드 스테이지</text>
    
    <!-- Build steps -->
    <rect x="70" y="120" width="260" height="40" fill="#fff" stroke="#0277bd" stroke-width="2" rx="8"/>
    <text x="200" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">FROM node:18 AS builder</text>
    
    <rect x="70" y="170" width="260" height="40" fill="#fff" stroke="#0277bd" stroke-width="2" rx="8"/>
    <text x="200" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">COPY package*.json ./</text>
    
    <rect x="70" y="220" width="260" height="40" fill="#fff" stroke="#0277bd" stroke-width="2" rx="8"/>
    <text x="200" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">RUN npm install</text>
    
    <rect x="70" y="270" width="260" height="40" fill="#fff" stroke="#0277bd" stroke-width="2" rx="8"/>
    <text x="200" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">RUN npm run build</text>
    
    <!-- Build artifacts -->
    <ellipse cx="200" cy="340" rx="80" ry="20" fill="#ffeb3b" stroke="#f57c00" stroke-width="2"/>
    <text x="200" y="345" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333">빌드 아티팩트</text>
  </g>
  
  <!-- Arrow from build to production -->
  <path d="M 360 225 Q 400 225 440 225" stroke="#666" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
  <text x="400" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666">COPY --from=builder</text>
  
  <!-- Production Stage -->
  <g id="prodStage">
    <rect x="450" y="70" width="300" height="300" fill="url(#prodGradient)" stroke="#4caf50" stroke-width="3" rx="15"/>
    <text x="600" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#fff">프로덕션 스테이지</text>
    
    <!-- Production steps -->
    <rect x="470" y="120" width="260" height="40" fill="#fff" stroke="#4caf50" stroke-width="2" rx="8"/>
    <text x="600" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">FROM nginx:alpine</text>
    
    <rect x="470" y="170" width="260" height="40" fill="#fff" stroke="#4caf50" stroke-width="2" rx="8"/>
    <text x="600" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">COPY --from=builder /app/dist</text>
    
    <rect x="470" y="220" width="260" height="40" fill="#fff" stroke="#4caf50" stroke-width="2" rx="8"/>
    <text x="600" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">EXPOSE 80</text>
    
    <rect x="470" y="270" width="260" height="40" fill="#fff" stroke="#4caf50" stroke-width="2" rx="8"/>
    <text x="600" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">CMD ["nginx", "-g", "daemon off;"]</text>
    
    <!-- Final image -->
    <ellipse cx="600" cy="340" rx="80" ry="20" fill="#c8e6c9" stroke="#4caf50" stroke-width="2"/>
    <text x="600" y="345" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333">최적화된 이미지</text>
  </g>
  
  <!-- Benefits section -->
  <rect x="50" y="390" width="700" height="50" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" rx="10"/>
  <text x="400" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#7b1fa2">멀티 스테이지 빌드 장점</text>
  <text x="400" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#7b1fa2">🔹 이미지 크기 최소화  🔹 보안 강화  🔹 빌드 도구 분리  🔹 프로덕션 최적화</text>
  
  <!-- Size comparison -->
  <g id="sizeComparison">
    <!-- Build stage size -->
    <circle cx="200" cy="50" r="15" fill="#ff9800"/>
    <text x="200" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#fff">1.2GB</text>
    
    <!-- Production stage size -->
    <circle cx="600" cy="50" r="15" fill="#4caf50"/>
    <text x="600" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#fff">50MB</text>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#666"/>
    </marker>
  </defs>
</svg>