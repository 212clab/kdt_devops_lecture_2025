# Session 5: ÌôòÍ≤Ω Î≥ÄÏàòÏôÄ Ïã§Ìñâ Î™ÖÎ†πÏñ¥ ÏÑ§Ï†ï

## üìç ÍµêÍ≥ºÍ≥ºÏ†ïÏóêÏÑúÏùò ÏúÑÏπò
Ïù¥ ÏÑ∏ÏÖòÏùÄ **Week 2 > Day 2 > Session 5**Î°ú, DockerfileÏóêÏÑú ÌôòÍ≤Ω ÏÑ§Ï†ïÍ≥º Ïã§Ìñâ Î™ÖÎ†πÏñ¥Î•º Îã§Î£®Îäî ÌïµÏã¨ Î™ÖÎ†πÏñ¥Îì§ÏùÑ Ïã§ÏäµÌï©ÎãàÎã§. Session 4Ïùò Ìå®ÌÇ§ÏßÄ ÏÑ§ÏπòÎ•º Î∞îÌÉïÏúºÎ°ú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùò ÎèôÏûëÏùÑ Ï†úÏñ¥ÌïòÎäî Î∞©Î≤ïÏùÑ ÌïôÏäµÌï©ÎãàÎã§.

## ÌïôÏäµ Î™©Ìëú (5Î∂Ñ)
- **ENV, ARG, CMD, ENTRYPOINT** Î™ÖÎ†πÏñ¥ **Ï∞®Ïù¥Ï†ê** Ïù¥Ìï¥
- **ÏÑ§Ï†ï Í∞ÄÎä•Ìïú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò** Ïù¥ÎØ∏ÏßÄ Íµ¨Ï∂ï Ïã§Ïäµ
- **ÎπåÎìú ÏãúÏ†ê vs Îü∞ÌÉÄÏûÑ** ÏÑ§Ï†ï Í¥ÄÎ¶¨ Î∞©Î≤ï ÌïôÏäµ

## 1. Ïù¥Î°†: ENV, ARG, CMD, ENTRYPOINT Ï∞®Ïù¥Ï†ê (20Î∂Ñ)

### ÌôòÍ≤Ω ÏÑ§Ï†ï Î™ÖÎ†πÏñ¥ ÎπÑÍµê

```mermaid
graph TB
    subgraph "ÎπåÎìú ÏãúÏ†ê"
        A[ARG] --> B[ÎπåÎìú Ïù∏Ïàò]
        A --> C[Dockerfile ÎÇ¥ÏóêÏÑúÎßå ÏÇ¨Ïö©]
        A --> D[docker build --build-arg]
    end
    
    subgraph "Îü∞ÌÉÄÏûÑ"
        E[ENV] --> F[ÌôòÍ≤Ω Î≥ÄÏàò]
        E --> G[Ïª®ÌÖåÏù¥ÎÑà Ïã§Ìñâ Ï§ë Ïú†ÏßÄ]
        E --> H[docker run -e]
        
        I[CMD] --> J[Í∏∞Î≥∏ Ïã§Ìñâ Î™ÖÎ†πÏñ¥]
        I --> K[docker runÏúºÎ°ú ÎçÆÏñ¥Ïì∞Í∏∞ Í∞ÄÎä•]
        
        L[ENTRYPOINT] --> M[Í≥†Ï†ï Ïã§Ìñâ Î™ÖÎ†πÏñ¥]
        L --> N[Ìï≠ÏÉÅ Ïã§ÌñâÎê®]
    end
```

### Î™ÖÎ†πÏñ¥Î≥Ñ ÌäπÏßïÍ≥º ÏÇ¨Ïö© ÏãúÏ†ê

| Î™ÖÎ†πÏñ¥ | ÏÇ¨Ïö© ÏãúÏ†ê | ÎçÆÏñ¥Ïì∞Í∏∞ | Ïö©ÎèÑ | ÏòàÏãú |
|--------|-----------|----------|------|------|
| **ARG** | ÎπåÎìú Ïãú | ‚ùå | ÎπåÎìú Ïù∏Ïàò | `ARG VERSION=1.0` |
| **ENV** | Îü∞ÌÉÄÏûÑ | ‚úÖ | ÌôòÍ≤Ω Î≥ÄÏàò | `ENV NODE_ENV=production` |
| **CMD** | Îü∞ÌÉÄÏûÑ | ‚úÖ | Í∏∞Î≥∏ Î™ÖÎ†πÏñ¥ | `CMD ["npm", "start"]` |
| **ENTRYPOINT** | Îü∞ÌÉÄÏûÑ | ‚ùå | Í≥†Ï†ï Î™ÖÎ†πÏñ¥ | `ENTRYPOINT ["docker-entrypoint.sh"]` |

### CMD vs ENTRYPOINT Ï°∞Ìï© Ìå®ÌÑ¥

```dockerfile
# Ìå®ÌÑ¥ 1: CMDÎßå ÏÇ¨Ïö© (ÏôÑÏ†Ñ ÎçÆÏñ¥Ïì∞Í∏∞ Í∞ÄÎä•)
CMD ["npm", "start"]
# docker run myapp ‚Üí npm start Ïã§Ìñâ
# docker run myapp echo "hello" ‚Üí echo "hello" Ïã§Ìñâ

# Ìå®ÌÑ¥ 2: ENTRYPOINTÎßå ÏÇ¨Ïö© (Í≥†Ï†ï Ïã§Ìñâ)
ENTRYPOINT ["npm", "start"]
# docker run myapp ‚Üí npm start Ïã§Ìñâ
# docker run myapp echo "hello" ‚Üí npm start echo "hello" Ïã§Ìñâ (Ïò§Î•ò)

# Ìå®ÌÑ¥ 3: ENTRYPOINT + CMD Ï°∞Ìï© (Í∂åÏû•)
ENTRYPOINT ["npm"]
CMD ["start"]
# docker run myapp ‚Üí npm start Ïã§Ìñâ
# docker run myapp run dev ‚Üí npm run dev Ïã§Ìñâ
```

## 2. Ïã§Ïäµ: ÏÑ§Ï†ï Í∞ÄÎä•Ìïú Ïõπ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò (15Î∂Ñ)

### ÌôòÍ≤ΩÎ≥Ñ ÏÑ§Ï†ïÏù¥ Í∞ÄÎä•Ìïú Express Ïï±

```bash
# Ïã§Ïäµ ÎîîÎ†âÌÜ†Î¶¨ ÏÉùÏÑ±
mkdir -p ~/docker-practice/day2/session5/configurable-app
cd ~/docker-practice/day2/session5/configurable-app

# ÏÑ§Ï†ï Í∞ÄÎä•Ìïú Express Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò
cat > server.js << 'EOF'
const express = require('express');
const path = require('path');

const app = express();

// ÌôòÍ≤Ω Î≥ÄÏàòÏóêÏÑú ÏÑ§Ï†ï ÏùΩÍ∏∞
const config = {
  port: process.env.PORT || 3000,
  env: process.env.NODE_ENV || 'development',
  appName: process.env.APP_NAME || 'Configurable App',
  version: process.env.APP_VERSION || '1.0.0',
  debug: process.env.DEBUG === 'true',
  maxConnections: parseInt(process.env.MAX_CONNECTIONS) || 100,
  dbUrl: process.env.DATABASE_URL || 'sqlite://memory',
  logLevel: process.env.LOG_LEVEL || 'info'
};

// ÎØ∏Îì§Ïõ®Ïñ¥
app.use(express.json());

// Ï†ïÏ†Å ÌååÏùº ÏÑúÎπô
app.use(express.static('public'));

// ÎùºÏö∞Ìä∏
app.get('/', (req, res) => {
  res.json({
    message: `Welcome to ${config.appName}!`,
    version: config.version,
    environment: config.env,
    timestamp: new Date().toISOString(),
    config: {
      port: config.port,
      debug: config.debug,
      maxConnections: config.maxConnections,
      logLevel: config.logLevel
    }
  });
});

app.get('/config', (req, res) => {
  res.json({
    ...config,
    // ÎØºÍ∞êÌïú Ï†ïÎ≥¥Îäî ÎßàÏä§ÌÇπ
    dbUrl: config.dbUrl.replace(/\/\/.*@/, '//***:***@')
  });
});

app.get('/health', (req, res) => {
  res.json({
    status: 'healthy',
    uptime: process.uptime(),
    memory: process.memoryUsage(),
    timestamp: new Date().toISOString()
  });
});

// ÌôòÍ≤ΩÎ≥Ñ Î°úÍπÖ
const logRequest = (req, res, next) => {
  if (config.debug) {
    console.log(`${new Date().toISOString()} - ${req.method} ${req.path}`);
  }
  next();
};

app.use(logRequest);

// ÏÑúÎ≤Ñ ÏãúÏûë
app.listen(config.port, '0.0.0.0', () => {
  console.log(`üöÄ ${config.appName} v${config.version}`);
  console.log(`üìä Environment: ${config.env}`);
  console.log(`üåê Server running on port ${config.port}`);
  console.log(`üêõ Debug mode: ${config.debug}`);
  console.log(`üìä Log level: ${config.logLevel}`);
});
EOF

# package.json
cat > package.json << 'EOF'
{
  "name": "configurable-app",
  "version": "1.0.0",
  "scripts": {
    "start": "node server.js",
    "dev": "NODE_ENV=development DEBUG=true node server.js",
    "prod": "NODE_ENV=production node server.js"
  },
  "dependencies": {
    "express": "^4.18.2"
  }
}
EOF

# Ï†ïÏ†Å ÌååÏùº
mkdir -p public
cat > public/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>Configurable Docker App</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .config { background: #f5f5f5; padding: 15px; border-radius: 5px; }
        .env-var { margin: 5px 0; }
    </style>
</head>
<body>
    <h1>üê≥ Configurable Docker Application</h1>
    <div class="config">
        <h3>Environment Configuration</h3>
        <div id="config-info">Loading...</div>
    </div>
    
    <script>
        fetch('/config')
            .then(r => r.json())
            .then(config => {
                const configDiv = document.getElementById('config-info');
                configDiv.innerHTML = Object.entries(config)
                    .map(([key, value]) => `<div class="env-var"><strong>${key}:</strong> ${value}</div>`)
                    .join('');
            });
    </script>
</body>
</html>
EOF
```

### ARGÏôÄ ENVÎ•º ÌôúÏö©Ìïú Dockerfile

```dockerfile
# ÏÑ§Ï†ï Í∞ÄÎä•Ìïú Dockerfile
cat > Dockerfile << 'EOF'
FROM node:18-alpine

# ÎπåÎìú Ïù∏Ïàò Ï†ïÏùò (Í∏∞Î≥∏Í∞í Ìè¨Ìï®)
ARG NODE_ENV=production
ARG APP_VERSION=1.0.0
ARG BUILD_DATE
ARG VCS_REF

# Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ (ÎπåÎìú Ïù∏Ïàò ÌôúÏö©)
LABEL maintainer="student@example.com" \
      version="${APP_VERSION}" \
      build-date="${BUILD_DATE}" \
      vcs-ref="${VCS_REF}" \
      description="Configurable Node.js application"

# Îü∞ÌÉÄÏûÑ ÌôòÍ≤Ω Î≥ÄÏàò ÏÑ§Ï†ï (ARG Í∞í ÏÇ¨Ïö©)
ENV NODE_ENV=${NODE_ENV} \
    APP_VERSION=${APP_VERSION} \
    APP_NAME="Configurable Docker App" \
    PORT=3000 \
    DEBUG=false \
    LOG_LEVEL=info \
    MAX_CONNECTIONS=100

# Ï°∞Í±¥Î∂Ä Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò (Í∞úÎ∞ú ÌôòÍ≤ΩÏóêÏÑúÎßå Ï∂îÍ∞Ä ÎèÑÍµ¨)
RUN if [ "$NODE_ENV" = "development" ]; then \
        apk add --no-cache curl vim; \
    fi

WORKDIR /app

# ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò
COPY package*.json ./
RUN npm ci --only=production

# ÏÜåÏä§ ÏΩîÎìú Î≥µÏÇ¨
COPY . .

# Ìè¨Ìä∏ ÎÖ∏Ï∂ú (ÌôòÍ≤Ω Î≥ÄÏàò ÏÇ¨Ïö©)
EXPOSE ${PORT}

# Ìó¨Ïä§Ï≤¥ÌÅ¨ (ÌôòÍ≤ΩÏóê Îî∞Îùº Îã§Î•∏ Í∞ÑÍ≤©)
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:${PORT}/health || exit 1

# ENTRYPOINTÏôÄ CMD Ï°∞Ìï©
ENTRYPOINT ["npm"]
CMD ["start"]
EOF
```

## 3. Ïã§Ïäµ: ÎπåÎìú Ïù∏ÏàòÏôÄ ÌôòÍ≤ΩÎ≥Ñ ÎπåÎìú (10Î∂Ñ)

### ÌôòÍ≤ΩÎ≥Ñ Ïù¥ÎØ∏ÏßÄ ÎπåÎìú

```bash
# Í∞úÎ∞ú ÌôòÍ≤Ω ÎπåÎìú
docker build \
  --build-arg NODE_ENV=development \
  --build-arg APP_VERSION=1.0.0-dev \
  --build-arg BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ') \
  --build-arg VCS_REF=$(git rev-parse --short HEAD 2>/dev/null || echo "unknown") \
  -t configurable-app:dev .

# ÌîÑÎ°úÎçïÏÖò ÌôòÍ≤Ω ÎπåÎìú
docker build \
  --build-arg NODE_ENV=production \
  --build-arg APP_VERSION=1.0.0 \
  --build-arg BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ') \
  -t configurable-app:prod .

# Ïù¥ÎØ∏ÏßÄ Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÌôïÏù∏
docker inspect configurable-app:dev --format='{{json .Config.Labels}}' | jq
docker inspect configurable-app:prod --format='{{json .Config.Labels}}' | jq
```

### Îã§ÏñëÌïú ÌôòÍ≤Ω Î≥ÄÏàòÎ°ú Ïã§Ìñâ ÌÖåÏä§Ìä∏

```bash
# Í∏∞Î≥∏ ÏÑ§Ï†ïÏúºÎ°ú Ïã§Ìñâ
docker run -d -p 8080:3000 --name app-default configurable-app:prod

# Ïª§Ïä§ÌÖÄ ÌôòÍ≤Ω Î≥ÄÏàòÎ°ú Ïã§Ìñâ
docker run -d -p 8081:3000 \
  -e APP_NAME="Custom Docker App" \
  -e DEBUG=true \
  -e LOG_LEVEL=debug \
  -e MAX_CONNECTIONS=200 \
  --name app-custom configurable-app:prod

# ÌôòÍ≤Ω ÌååÏùº ÏÇ¨Ïö©
cat > app.env << 'EOF'
APP_NAME=Environment File App
NODE_ENV=staging
DEBUG=true
LOG_LEVEL=warn
MAX_CONNECTIONS=50
DATABASE_URL=postgresql://user:pass@db:5432/myapp
EOF

docker run -d -p 8082:3000 \
  --env-file app.env \
  --name app-envfile configurable-app:prod

# Í∞Å Ïª®ÌÖåÏù¥ÎÑà ÏÑ§Ï†ï ÌôïÏù∏
echo "=== Default Configuration ==="
curl -s http://localhost:8080/config | jq

echo -e "\n=== Custom Configuration ==="
curl -s http://localhost:8081/config | jq

echo -e "\n=== Environment File Configuration ==="
curl -s http://localhost:8082/config | jq
```

## 4. Ïã§Ïäµ: ENTRYPOINT Ïä§ÌÅ¨Î¶ΩÌä∏ Ìå®ÌÑ¥ (10Î∂Ñ)

### Ï¥àÍ∏∞Ìôî Ïä§ÌÅ¨Î¶ΩÌä∏Í∞Ä ÏûàÎäî Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò

```bash
# ÏóîÌä∏Î¶¨Ìè¨Ïù∏Ìä∏ Ïä§ÌÅ¨Î¶ΩÌä∏ ÏÉùÏÑ±
cat > docker-entrypoint.sh << 'EOF'
#!/bin/sh
set -e

# ÌôòÍ≤Ω Î≥ÄÏàò Í≤ÄÏ¶ù
validate_env() {
    echo "üîç Validating environment variables..."
    
    if [ -z "$APP_NAME" ]; then
        echo "‚ùå APP_NAME is required"
        exit 1
    fi
    
    if [ "$NODE_ENV" = "production" ] && [ -z "$DATABASE_URL" ]; then
        echo "‚ö†Ô∏è  Warning: DATABASE_URL not set in production"
    fi
    
    echo "‚úÖ Environment validation passed"
}

# Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ (ÏãúÎÆ¨Î†àÏù¥ÏÖò)
test_database() {
    if [ -n "$DATABASE_URL" ]; then
        echo "üîó Testing database connection..."
        # Ïã§Ï†úÎ°úÎäî Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ïó∞Í≤∞ ÌÖåÏä§Ìä∏
        sleep 1
        echo "‚úÖ Database connection successful"
    fi
}

# Î°úÍ∑∏ ÎîîÎ†âÌÜ†Î¶¨ ÏÉùÏÑ±
setup_logging() {
    echo "üìù Setting up logging..."
    mkdir -p /app/logs
    touch /app/logs/app.log
    echo "‚úÖ Logging setup complete"
}

# Ï¥àÍ∏∞Ìôî Ïã§Ìñâ
echo "üöÄ Starting ${APP_NAME} v${APP_VERSION}"
echo "üìä Environment: ${NODE_ENV}"

validate_env
test_database
setup_logging

echo "üéØ Initialization complete, starting application..."

# ÏõêÎûò Î™ÖÎ†πÏñ¥ Ïã§Ìñâ
exec "$@"
EOF

# Ïã§Ìñâ Í∂åÌïú Î∂ÄÏó¨
chmod +x docker-entrypoint.sh
```

### ENTRYPOINT Ïä§ÌÅ¨Î¶ΩÌä∏Î•º ÏÇ¨Ïö©ÌïòÎäî Dockerfile

```dockerfile
# Dockerfile.entrypoint
cat > Dockerfile.entrypoint << 'EOF'
FROM node:18-alpine

# ÌïÑÏàò ÎèÑÍµ¨ ÏÑ§Ïπò
RUN apk add --no-cache curl

WORKDIR /app

# ÏóîÌä∏Î¶¨Ìè¨Ïù∏Ìä∏ Ïä§ÌÅ¨Î¶ΩÌä∏ Î≥µÏÇ¨
COPY docker-entrypoint.sh /usr/local/bin/
RUN chmod +x /usr/local/bin/docker-entrypoint.sh

# Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò ÌååÏùº Î≥µÏÇ¨
COPY package*.json ./
RUN npm ci --only=production

COPY . .

# ÌôòÍ≤Ω Î≥ÄÏàò Í∏∞Î≥∏Í∞í
ENV APP_NAME="Docker App" \
    APP_VERSION="1.0.0" \
    NODE_ENV="production" \
    PORT=3000

EXPOSE 3000

# ENTRYPOINT Ïä§ÌÅ¨Î¶ΩÌä∏ ÏÇ¨Ïö©
ENTRYPOINT ["docker-entrypoint.sh"]
CMD ["npm", "start"]
EOF

# ÎπåÎìú Î∞è ÌÖåÏä§Ìä∏
docker build -f Dockerfile.entrypoint -t configurable-app:entrypoint .

# Ï†ïÏÉÅ Ïã§Ìñâ ÌÖåÏä§Ìä∏
docker run -d -p 8083:3000 \
  -e APP_NAME="Entrypoint Test App" \
  -e DATABASE_URL="postgresql://localhost:5432/test" \
  --name app-entrypoint configurable-app:entrypoint

# Î°úÍ∑∏ ÌôïÏù∏ (Ï¥àÍ∏∞Ìôî Í≥ºÏ†ï)
docker logs app-entrypoint

# ÌôòÍ≤Ω Î≥ÄÏàò ÎàÑÎùΩ ÌÖåÏä§Ìä∏
docker run --rm \
  -e APP_NAME="" \
  configurable-app:entrypoint echo "This should fail"
```

## 5. Ïã§Ïäµ: Îã§Ï§ë Î™ÖÎ†πÏñ¥ ÏßÄÏõê Ìå®ÌÑ¥ (10Î∂Ñ)

### Ïú†Ïó∞Ìïú Î™ÖÎ†πÏñ¥ Ïã§ÌñâÏù¥ Í∞ÄÎä•Ìïú Ïù¥ÎØ∏ÏßÄ

```bash
# Îã§Î™©Ï†Å ÏóîÌä∏Î¶¨Ìè¨Ïù∏Ìä∏ Ïä§ÌÅ¨Î¶ΩÌä∏
cat > flexible-entrypoint.sh << 'EOF'
#!/bin/sh
set -e

# ÎèÑÏõÄÎßê ÌëúÏãú
show_help() {
    echo "Available commands:"
    echo "  start     - Start the application (default)"
    echo "  dev       - Start in development mode"
    echo "  test      - Run tests"
    echo "  migrate   - Run database migrations"
    echo "  shell     - Open interactive shell"
    echo "  help      - Show this help"
}

# Î™ÖÎ†πÏñ¥ Ï≤òÎ¶¨
case "$1" in
    start|"")
        echo "üöÄ Starting application in ${NODE_ENV} mode..."
        exec npm start
        ;;
    dev)
        echo "üîß Starting in development mode..."
        export NODE_ENV=development
        export DEBUG=true
        exec npm run dev
        ;;
    test)
        echo "üß™ Running tests..."
        exec npm test
        ;;
    migrate)
        echo "üóÑÔ∏è Running database migrations..."
        # Ïã§Ï†úÎ°úÎäî ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ïä§ÌÅ¨Î¶ΩÌä∏ Ïã§Ìñâ
        echo "Migrations completed"
        ;;
    shell)
        echo "üêö Opening interactive shell..."
        exec /bin/sh
        ;;
    help)
        show_help
        ;;
    *)
        echo "üöÄ Executing custom command: $*"
        exec "$@"
        ;;
esac
EOF

chmod +x flexible-entrypoint.sh
```

### Îã§Î™©Ï†Å Dockerfile

```dockerfile
# Dockerfile.flexible
cat > Dockerfile.flexible << 'EOF'
FROM node:18-alpine

RUN apk add --no-cache curl

WORKDIR /app

# ÏóîÌä∏Î¶¨Ìè¨Ïù∏Ìä∏ Ïä§ÌÅ¨Î¶ΩÌä∏
COPY flexible-entrypoint.sh /usr/local/bin/entrypoint.sh
RUN chmod +x /usr/local/bin/entrypoint.sh

# Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò ÏÑ§Ï†ï
COPY package*.json ./
RUN npm install  # Í∞úÎ∞ú ÏùòÏ°¥ÏÑ±ÎèÑ Ìè¨Ìï®

COPY . .

ENV NODE_ENV=production \
    PORT=3000

EXPOSE 3000

ENTRYPOINT ["entrypoint.sh"]
CMD ["start"]
EOF

# ÎπåÎìú
docker build -f Dockerfile.flexible -t configurable-app:flexible .

# Îã§ÏñëÌïú Î™ÖÎ†πÏñ¥ ÌÖåÏä§Ìä∏
echo "=== Help ==="
docker run --rm configurable-app:flexible help

echo -e "\n=== Default Start ==="
docker run -d -p 8084:3000 --name app-flexible configurable-app:flexible

echo -e "\n=== Development Mode ==="
docker run --rm configurable-app:flexible dev &
sleep 2 && kill %1 2>/dev/null || true

echo -e "\n=== Shell Access ==="
docker run --rm -it configurable-app:flexible shell -c "echo 'Inside container'; ls -la"

echo -e "\n=== Custom Command ==="
docker run --rm configurable-app:flexible echo "Custom command executed"
```

## 6. Q&A Î∞è Ï†ïÎ¶¨ (5Î∂Ñ)

### ÌôòÍ≤Ω ÏÑ§Ï†ï Î™ÖÎ†πÏñ¥ ÏÑ†ÌÉù Í∞ÄÏù¥Îìú

```mermaid
flowchart TD
    A[ÌôòÍ≤Ω ÏÑ§Ï†ï ÌïÑÏöî] --> B{Ïñ∏Ï†ú ÏÑ§Ï†ï?}
    B -->|ÎπåÎìú Ïãú| C[ARG ÏÇ¨Ïö©]
    B -->|Îü∞ÌÉÄÏûÑ| D{Î≥ÄÍ≤Ω Í∞ÄÎä•?}
    
    D -->|Yes| E[ENV ÏÇ¨Ïö©]
    D -->|No| F{Ïã§Ìñâ Î∞©Ïãù?}
    
    F -->|Í≥†Ï†ï Î™ÖÎ†πÏñ¥| G[ENTRYPOINT ÏÇ¨Ïö©]
    F -->|Ïú†Ïó∞Ìïú Î™ÖÎ†πÏñ¥| H[CMD ÏÇ¨Ïö©]
    F -->|Ï°∞Ìï©| I[ENTRYPOINT + CMD]
```

### Ïã§Ïäµ Í≤∞Í≥º Ï†ïÎ¶¨

```bash
# Ïã§Ìñâ Ï§ëÏù∏ Ïª®ÌÖåÏù¥ÎÑàÎì§ ÌôïÏù∏
docker ps --format "table {{.Names}}\t{{.Image}}\t{{.Ports}}"

# Í∞Å Ïª®ÌÖåÏù¥ÎÑàÏùò ÌôòÍ≤Ω Î≥ÄÏàò ÌôïÏù∏
for container in app-default app-custom app-envfile app-entrypoint app-flexible; do
    echo "=== $container ==="
    docker exec $container env | grep -E "(APP_|NODE_|PORT|DEBUG)" | sort
    echo
done

# Ï†ïÎ¶¨
docker stop $(docker ps -q) 2>/dev/null || true
docker rm $(docker ps -aq) 2>/dev/null || true
```

## üí° ÌïµÏã¨ ÌÇ§ÏõåÎìú
- **ARG**: ÎπåÎìú ÏãúÏ†ê Ïù∏Ïàò, --build-argÎ°ú Ï†ÑÎã¨
- **ENV**: Îü∞ÌÉÄÏûÑ ÌôòÍ≤Ω Î≥ÄÏàò, -e ÏòµÏÖòÏúºÎ°ú ÎçÆÏñ¥Ïì∞Í∏∞ Í∞ÄÎä•
- **CMD**: Í∏∞Î≥∏ Ïã§Ìñâ Î™ÖÎ†πÏñ¥, docker runÏúºÎ°ú ÎçÆÏñ¥Ïì∞Í∏∞ Í∞ÄÎä•
- **ENTRYPOINT**: Í≥†Ï†ï Ïã§Ìñâ Î™ÖÎ†πÏñ¥, Ìï≠ÏÉÅ Ïã§ÌñâÎê®

## üìö Ï∞∏Í≥† ÏûêÎ£å
- [Dockerfile ENV Î†àÌçºÎü∞Ïä§](https://docs.docker.com/engine/reference/builder/#env)
- [ENTRYPOINT vs CMD](https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact)
- [Docker ÌôòÍ≤Ω Î≥ÄÏàò Í∞ÄÏù¥Îìú](https://docs.docker.com/engine/reference/run/#env-environment-variables)

## üîß Ïã§Ïäµ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏
- [ ] ARGÏôÄ ENV Î™ÖÎ†πÏñ¥ Ï∞®Ïù¥Ï†ê Ïù¥Ìï¥
- [ ] ÎπåÎìú Ïù∏ÏàòÎ°ú ÌôòÍ≤ΩÎ≥Ñ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
- [ ] Îü∞ÌÉÄÏûÑ ÌôòÍ≤Ω Î≥ÄÏàòÎ°ú ÎèôÏûë Ï†úÏñ¥
- [ ] ENTRYPOINT Ïä§ÌÅ¨Î¶ΩÌä∏Î°ú Ï¥àÍ∏∞Ìôî Î°úÏßÅ Íµ¨ÌòÑ
- [ ] CMDÏôÄ ENTRYPOINT Ï°∞Ìï©ÏúºÎ°ú Ïú†Ïó∞Ìïú Ïã§Ìñâ
